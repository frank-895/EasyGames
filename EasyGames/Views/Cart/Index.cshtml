<!-- Page generated by ChatGPT using my models, services, and controller actions -->

@model EasyGames.Models.Cart

@{
    ViewData["Title"] = "Shopping Cart";
}

<h2>@ViewData["Title"]</h2>


@if (Model?.CartProducts?.Any() == true)
{
    <div class="row g-3">
        <div class="col-xl-8">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Cart Items</h5>
                </div>
                <div class="card-body p-2 p-md-3">
                    @foreach (var item in Model.CartProducts)
                    {
                        <div class="row g-2 g-md-3 align-items-center mb-3 pb-3 border-bottom">
                            <div class="col-3 col-lg-2">
                                <img src="@(string.IsNullOrWhiteSpace(item.Product.ImageUrl) ? Url.Content("~/images/placeholder.svg") : item.Product.ImageUrl)"
                                     alt="Product Image" class="img-fluid rounded" style="max-height: 60px;" />
                            </div>
                            <div class="col-9 col-lg-4">
                                <h6 class="mb-1 fs-6">
                                    @{
                                        string productName = "";
                                        switch (item.ProductType)
                                        {
                                            case EasyGames.Models.ProductType.Book:
                                                productName = ((EasyGames.Models.Book)item.Product).Title;
                                                break;
                                            case EasyGames.Models.ProductType.Game:
                                                productName = ((EasyGames.Models.Game)item.Product).Title;
                                                break;
                                            case EasyGames.Models.ProductType.Toy:
                                                productName = ((EasyGames.Models.Toy)item.Product).Name;
                                                break;
                                        }
                                    }
                                    @productName
                                </h6>
                                <small class="text-muted">@item.ProductType</small>
                                <div class="d-lg-none mt-2">
                                    <strong class="text-success">@item.Product.Price.ToString("C")</strong>
                                </div>
                            </div>
                            <div class="col-6 col-lg-2 d-none d-lg-block text-center">
                                <strong>@item.Product.Price.ToString("C")</strong>
                            </div>
                            <div class="col-6 col-lg-2">
                                <form asp-controller="Cart" asp-action="UpdateQuantity" method="post" class="d-inline">
                                    <input type="hidden" name="productId" value="@item.ProductId" />
                                    <input type="hidden" name="productType" value="@item.ProductType" />
                                    <div class="input-group input-group-sm">
                                        <input type="number" name="quantity" value="@item.Quantity" min="1" max="99" class="form-control text-center" style="max-width: 70px;" onchange="this.form.submit()" />
                                    </div>
                                </form>
                            </div>
                            <div class="col-6 col-lg-2">
                                <form asp-controller="Cart" asp-action="RemoveFromCart" method="post" class="d-inline w-100">
                                    <input type="hidden" name="productId" value="@item.ProductId" />
                                    <input type="hidden" name="productType" value="@item.ProductType" />
                                    <button type="submit" class="btn btn-sm btn-outline-danger w-100">Remove</button>
                                </form>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
        <div class="col-xl-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Order Summary</h5>
                </div>
                <div class="card-body">
                    @{
                        decimal total = Model.CartProducts.Sum(cp => cp.Product.Price * cp.Quantity);
                        int totalItems = Model.CartProducts.Sum(cp => cp.Quantity);
                    }
                    <div class="d-flex justify-content-between mb-2">
                        <span>Items (@totalItems)</span>
                        <strong>@total.ToString("C")</strong>
                    </div>
                    <hr>
                    <div class="d-flex justify-content-between mb-3">
                        <strong>Total</strong>
                        <strong>@total.ToString("C")</strong>
                    </div>
                    <button type="button" class="btn btn-primary w-100 mb-2" disabled>Proceed to Checkout</button>
                    <form asp-controller="Cart" asp-action="ClearCart" method="post">
                        <button type="submit" class="btn btn-outline-secondary w-100" onclick="return confirm('Are you sure you want to clear your cart?')">Clear Cart</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <div class="text-center py-5">
        <div class="mb-4">
            <i class="fas fa-shopping-cart fa-3x text-muted"></i>
        </div>
        <h4>Your cart is empty</h4>
        <p class="text-muted">Add some products to your cart to get started!</p>
        <div class="mt-4">
            <a asp-controller="Home" asp-action="Index" class="btn btn-primary">Continue Shopping</a>
        </div>
    </div>
}